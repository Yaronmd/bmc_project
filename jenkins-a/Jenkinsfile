pipeline {
    agent any

    stages {
        stage('Trigger Jenkins B') {
            steps {
                withCredentials([
                    usernamePassword(
                        credentialsId: 'jenkins_api_token_cred',
                        usernameVariable: 'JENKINS_USER',
                        passwordVariable: 'JENKINS_API_TOKEN'
                    ),
                    string(
                        credentialsId: 'jenkins_b_url_cred',
                        variable: 'JENKINS_B_URL'
                    )
                ]) {
                    sh '''
                    echo "Triggering Jenkins B on $JENKINS_B_URL"
                    echo "Using user: $JENKINS_USER"
                    /scripts/validate_ls.sh
                    '''
                }
            }
        }
    }
}
